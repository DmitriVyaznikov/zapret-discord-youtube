# Настройка zapret для игрового сервера 51.89.93.157:2302/2303

## Вопрос

Как дополнить `general (ALT).bat` чтобы обход работал для:
- `51.89.93.157:2302` (Game Port)
- `51.89.93.157:2303` (Query Port)

Также в логах VLESS-прокси видны адреса:
```
172.19.0.1 / 172.19.0.2:53
```

## Ответ

### Про логи VLESS

IP-адреса `172.19.0.1` и `172.19.0.2` — это внутренние адреса Docker-сети VLESS-прокси. Порт `:53` — это DNS. Эти адреса не имеют отношения к zapret и добавлять их никуда не нужно.

### Изменения для игрового сервера

#### 1. Добавить IP в `lists/ipset-all.txt`

Добавить строку:
```
51.89.93.157/32
```

#### 2. Изменить `general (ALT).bat`

**Добавить порты в capture filter (строка 15):**

```bat
--wf-tcp=80,443,2053,2083,2087,2096,2302,2303,8443,%GameFilter%
--wf-udp=443,2302,2303,19294-19344,50000-50100,%GameFilter%
```

**Добавить новую цепочку фильтрации (перед последней строкой):**

```bat
--filter-udp=2302,2303 --ipset="%LISTS%ipset-all.txt" --dpi-desync=fake --dpi-desync-repeats=6 --dpi-desync-any-protocol=1 --dpi-desync-fake-unknown-udp="%BIN%quic_initial_www_google_com.bin" --new ^
```

### Важное замечание

zapret обходит именно **DPI-фильтрацию** (анализ содержимого пакетов). Если сервер заблокирован по IP, а не по DPI — zapret не поможет, нужен VPN/прокси. Игровой трафик на портах 2302-2303 обычно чистый UDP без TLS/QUIC, и DPI-системы редко его анализируют — чаще блокируют по IP. В этом случае VLESS-прокси — правильное решение, а не zapret.
